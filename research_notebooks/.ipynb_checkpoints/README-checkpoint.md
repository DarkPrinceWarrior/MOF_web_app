# Создание методики синтеза по заданным параметрам выходного вещества

## Данные
Полный датасет находится под NDA. Демо датасет представлен в файле `demo_data.csv`<br>
Данных ~300 строк

## Текущий статус
Проект находится в разработке. Плановое завершение алгоритма - конец 2023 года.

## Проведённые эксперименты
### Постановка задачи:
Требуется предсказать 10 параметров ситнеза по двум требуемым характеристикам.
### Метрика (MNSWE):
В качестве метрики сконструирована кастомная метрика - "Средняя нормализованная суммарная взвещенная ошибка" (**MNSWE**).<br>
Расчёт происходит следующим образом:
1. Из каждого из 10 целевых параметров мы вычитаем предсказания и берём их модуль
2. Далее эти 10 абсолютных ошибок подвергаятся min-max нормализации (min/max берутся из соответствующих колонок исходного датасета)
3. Затем им придаётся свой вес (веса основаны на научной интуиции руководителя группы проекта)
4. После вышеперечисленного мы суммируем 10 ошибок и получаем одно значение, которое отражает степень ошьбочности в предсказании. Если в предсказании каждый параметр отличается от правды ровно на максимальное значение из датасета, то получим ошибку равную `1` или `100%`
5. На последнем шаге берём среднее по всем предскащаниям для тестовой выборки
### Протестированные подходы:
#### 1. Бустинг-библиотека для мульти-таргет регрессии (physlearn):
Самое очевидно решение использовать готовую библиотеку для данной задачи.<br>
Результат представлен в ноутбуке `test_00`.<br>
Ошибка предсказаний `MNSWE = 14% `
#### 2. Простая полносвязная нейронная сеть:
Результат представлен в ноутбуке `test_00`.<br>
Ошибка предсказаний `MNSWE = 17% `
#### 3. Хитрый подход с инвертированием, бустингом и генетическим алгоритмом:
#### Ход решения:
##### 1. Инвертировать задачу. Теперь мы предсказываем не 10 параметров по 2м зарактеристикам, а 2 характеристики по 10 параметрам.
При этом оба параметра предсказываются раздельно двумя разными бустинг алгоритмами.<br>
Обучение можно увидеть в ноутбуке `test_01`
##### 2. Теперь мы снова инвертируем задачу, возвращая её к первоначальной, но только подбираем такие параметры синтеза, для которых результат работы бустинг-алгоритмов будет равен запрашиваемым свойствам материала.
Для оптимизации перебора используем генетический алгоритм<br>
Результаты можно увидеть в ноутбуке `test_01_genetic`<br>
Ошибка предсказаний `MNSWE = 34% `


## Дальнейшие планы:
1. Тестирование GAN для подхода с инвертированием задачи
2. Подбор дополнительных фичей совместно с экспертами в облисти синтеза
